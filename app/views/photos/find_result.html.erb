<div class="search-result">

    <div class="row-fluid">   
        <div class="span6">
            <h1 class="page-title">Busca fotos</h1>
        </div>   
        <div class="span6">            
            <p id="basket_items" class='img-header'>
                <span> <%= basket.length unless basket == nil %> item no carrinho</span>
            </p>
        </div>
        <div class="span12">
            <div style="text-align: right; margin-right: 20px; margin-bottom: 7px">
                <%= link_to "Visualizar Carrinho", sale_view_sale_path, class: "btn btn-primary btn-finish-sale" %>
            </div>
        </div>  
    </div> 


    <%= form_tag find_result_path do %>
        <div class="form-inputs">
            <%= text_field_tag 'find_by_date', nil,:class => 'input-medium gray', :placeholder => "Busca por: Data" %>
            <%= text_field_tag 'find_by_keyword', nil,:class => 'input-large gray large', :placeholder => "Busca por: Palavra-chave" %>
            <%= image_submit_tag('buscar_button.png', :class => 'xbutton') %>
        </div>
    <% end %>

    <div class="results">
        <span class="emph">Sua Busca</span> retornou <%= @photos.size unless @photos == nil %> resultados!
    </div>
    <hr />


    <% @break_row = 5 %>
    <% @opened = 0 %>
    <div id="gallery" data-toggle="modal-gallery" data-target="#modal-gallery" data-selector="div.crop">
        <div class="row-fluid album-row">        
            <% @photos.each_with_index do |photo, index| %>      
                <% if index + 1 == @break_row %>
                    <% @break_row = @break_row + 4 %>
                    <% @opened = 1 %>
                    </div>
                    <div class="row-fluid album-row">
                <% end %>                   
                <div class="span3">
                    <div class="thumbnail">
                        <div class="crop" data-href="<%= photo.image_url(:medium).to_s %>" title="<%= photo.album.beach %>">
                            <%= image_tag photo.image_url(:thumb).to_s, :class => 'img-rounded'%>
                        </div>
                        <div class="description-buttons">
                            <a href="<%= sale_add_photo_path(photo.id) %>" class="btn btn-small btn-info buy" data-remote="true"> 
                                <i class="icon-shopping-cart"></i> 
                            </a>
                            <a href="<%=  album_path(photo.album) %>" class="btn btn-small see">
                                <i class="icon-eye-open"></i>
                            </a>
                        </div>
                    </div>
                </div>
            <% end %>
        </div>
        <% if @opened == 1 %>                
            </div>
        <% end %>
    </div>
</div>

<div id="modal-gallery" class="modal modal-gallery hide fade" tabindex="-1">
    <div class="modal-dismiss" >
        <a class="close" data-dismiss="modal">&times;</a>
    </div> 
    <div class="modal-body">
        <div class="modal-image"></div>
            <div class="modal-black-box">
                <div class="modal-title"></div>
            </div>
    </div>

</div>


<script type="text/javascript">
$(document).ready(function() {
    $('#container-right').hide();
    $('#content').removeClass('span9');
    // $('#content').addClass('full');
    $('#body').addClass('full');        
});
</script>

<script src="http://blueimp.github.com/JavaScript-Load-Image/load-image.min.js"></script>
<script src="https://raw.github.com/blueimp/Bootstrap-Image-Gallery/master/js/bootstrap-image-gallery.min.js"></script>

<script type="text/javascript">
    
$('#modal-gallery').on('displayed', function () {
    var modalData = $(this).data('modal');
    $(".modal-black-box").width($('.modal-image').width());
    $(".modal-title").width($('.modal-image').width());
    var img = $('.modal-image').width();
    var gal = $('.modal-gallery').width();
    var margin = ((gal - img)/2) + img - 20;
    $(".modal-dismiss").css('left', margin + "px");
    // modalData.$links is the list of (filtered) element nodes as jQuery object
    // modalData.img is the img (or canvas) element for the loaded image
    // modalData.options.index is the index of the current link
});
</script>